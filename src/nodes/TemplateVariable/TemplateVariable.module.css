/* Stable wrapper - NEVER changes, maintains all pill styling */
.wrapper {
  display: inline-flex;
  align-items: center;
  position: relative;

  /* Pill base styling */
  padding: 0.125rem 0.5rem; /* py-0.5 px-2 */
  margin: 0 0.125rem; /* mx-0.5 */
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; /* font-mono */
  font-size: 0.875rem; /* text-sm */
  background-color: color-mix(in oklch, var(--primary) 10%, transparent);
  color: var(--primary);
  border: 1px solid color-mix(in oklch, var(--primary) 20%, transparent);
  border-radius: 0.375rem; /* rounded-md */

  /* Smooth transitions for state changes */
  transition: border 150ms ease-out,
              background 150ms ease-out,
              box-shadow 150ms ease-out,
              outline 150ms ease-out,
              color 150ms ease-out;
}

/* Vibrant edit mode - saturated dashed border on the stable wrapper */
.editing {
  border: 2px dashed var(--primary);
  background: color-mix(in oklch, var(--primary) 20%, transparent);
  color: var(--primary);
  box-shadow: 0 0 0 3px color-mix(in oklch, var(--primary) 20%, transparent);
}

/* Compose mode (use mode) - green styling */
.useMode {
  background-color: color-mix(in oklch, var(--brand-green) 10%, transparent);
  color: var(--brand-green);
  border: 1px solid color-mix(in oklch, var(--brand-green) 20%, transparent);
}

.useModeEditing {
  border: 2px dashed var(--brand-green);
  background: color-mix(in oklch, var(--brand-green) 20%, transparent);
  color: var(--brand-green);
  box-shadow: 0 0 0 3px color-mix(in oklch, var(--brand-green) 20%, transparent);
}

/* Content container - smoothly transitions width as you type */
.content {
  display: inline-block;
  position: relative;
  transition: width 200ms ease-out;
  min-width: 1ch; /* Minimum width for empty values */
  overflow: visible; /* Prevent text clipping */
}

/* Brackets - non-editable decoration that hides in edit mode */
.bracket {
  user-select: none;
  pointer-events: none;
  display: inline;
}

/* Editable field - contenteditable span that acts like input */
.input {
  border: none;
  background: transparent;
  outline: none;
  padding: 0;
  margin: 0;
  font-family: inherit;
  font-size: inherit;
  color: inherit;
  width: 100%;
  display: block;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: clip;

  /* Prevent browser styling on contenteditable */
  -webkit-user-modify: read-write-plaintext-only;
}

/* Display text in non-edit mode */
.display {
  display: inline-block;
  white-space: nowrap;
}

/* First unfilled variable - strong pulse to draw attention */
.unfilledFirst {
  animation: pulseGlow 2s ease-in-out infinite;
  outline: 2px solid color-mix(in oklch, var(--primary) 50%, transparent);
  outline-offset: 0px;
  cursor: pointer;
}

.unfilledFirstUseMode {
  outline: 2px solid color-mix(in oklch, var(--brand-green) 50%, transparent);
}

/* Other unfilled variables - subtle indication */
.unfilled {
  outline: 1px dashed color-mix(in oklch, var(--primary) 40%, transparent);
  outline-offset: 0px;
  cursor: pointer;
}

.unfilledUseMode {
  outline: 1px dashed color-mix(in oklch, var(--brand-green) 40%, transparent);
}

/* Filled variables in compose mode - editable */
.filled {
  cursor: pointer;
}

/* Hover state for all editable variables */
.editable:hover {
  outline: 2px solid color-mix(in oklch, var(--primary) 60%, transparent);
  outline-offset: 0px;
}

.editableUseMode:hover {
  outline: 2px solid color-mix(in oklch, var(--brand-green) 60%, transparent);
}

/* Hidden measurement element for width calculation */
.measure {
  position: absolute;
  visibility: hidden;
  white-space: nowrap;
  pointer-events: none;
  left: -9999px;
}

/* Pulse glow animation for first unfilled variable */
@keyframes pulseGlow {
  0%, 100% {
    box-shadow: 0 0 0 0 color-mix(in oklch, var(--primary) 50%, transparent);
  }
  50% {
    box-shadow: 0 0 0 4px color-mix(in oklch, var(--primary) 60%, transparent);
  }
}

/* Disable animations for users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  .unfilledFirst {
    animation: none;
  }

  .wrapper,
  .content {
    transition: none !important;
  }
}
